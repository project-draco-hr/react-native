{
  final String bundleURL=createBundleURL(getDebugServerHost(),jsModulePath,getDevMode(),getHMR(),getJSMinifyMode());
  final Request request=new Request.Builder().url(bundleURL).build();
  mDownloadBundleFromURLCall=Assertions.assertNotNull(mClient.newCall(request));
  mDownloadBundleFromURLCall.enqueue(new Callback(){
    @Override public void onFailure(    Request request,    IOException e){
      if (mDownloadBundleFromURLCall == null || mDownloadBundleFromURLCall.isCanceled()) {
        mDownloadBundleFromURLCall=null;
        return;
      }
      mDownloadBundleFromURLCall=null;
      StringBuilder sb=new StringBuilder();
      sb.append("Could not connect to development server.\n\n").append("Try the following to fix the issue:\n").append("\u2022 Ensure that the packager server is running\n").append("\u2022 Ensure that your device/emulator is connected to your machine and has USB debugging enabled - run 'adb devices' to see a list of connected devices\n").append("\u2022 If you're on a physical device connected to the same machine, run 'adb reverse tcp:8081 tcp:8081' to forward requests from your device\n").append("\u2022 If your device is on the same Wi-Fi network, set 'Debug server host & port for device' in 'Dev settings' to your machine's IP address and the port of the local dev server - e.g. 10.0.1.1:8081\n\n").append("URL: ").append(request.urlString());
      callback.onFailure(new DebugServerException(sb.toString()));
    }
    @Override public void onResponse(    Response response) throws IOException {
      if (mDownloadBundleFromURLCall == null || mDownloadBundleFromURLCall.isCanceled()) {
        mDownloadBundleFromURLCall=null;
        return;
      }
      mDownloadBundleFromURLCall=null;
      if (!response.isSuccessful()) {
        String body=response.body().string();
        DebugServerException debugServerException=DebugServerException.parse(body);
        if (debugServerException != null) {
          callback.onFailure(debugServerException);
        }
 else {
          StringBuilder sb=new StringBuilder();
          sb.append("The development server returned response error code: ").append(response.code()).append("\n\n").append("URL: ").append(request.urlString()).append("\n\n").append("Body:\n").append(body);
          callback.onFailure(new DebugServerException(sb.toString()));
        }
        return;
      }
      Sink output=null;
      try {
        output=Okio.sink(outputFile);
        Okio.buffer(response.body().source()).readAll(output);
        callback.onSuccess();
      }
  finally {
        if (output != null) {
          output.close();
        }
      }
    }
  }
);
}
